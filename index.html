<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora da Barbie</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Lobster+Two:ital,wght@0,700;1,700&family=Playwrite+IN&family=Playwrite+IS:wght@100..400&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('https://wallpapers.com/images/hd/barbie-and-her-horse-ddjayj8u0u8tss8e.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            font-family: Arial, sans-serif;
        }
        .container-box {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            max-width: 520px;   /* Aumentado para caber os 3 bot√µes */
            width: 95%;         /* D√° mais espa√ßo sem estourar no mobile */
        }
        h1 { font-family: "Lobster", serif; color: #ff69b4; text-align: center; }
        h4 { color: #ff69b4; text-align: center; }
        label { color: #ff69b4; font-weight: bold; }
        .btn-custom { background-color: #ff69b4; border-color: #ff69b4; color: #fff; font-weight: bold; }
        .btn-custom:hover { background-color: #ff85c1; border-color: #ff85c1; }
        .result { background: #fff0f6; border-left: 6px solid #ff69b4; padding: 15px; margin-top: 20px; border-radius: 10px; }
        .btn-inline { display: inline-block; margin-right: 5px; margin-top: 5px; padding: 5px 10px; font-weight: bold; border-radius: 5px; }
        .btn-danger { background-color: #dc3545; color: #fff; border: none; }
        .btn-danger:hover { background-color: #c82333; }

        @media (max-width: 576px) {
            body {
                background-image: url('https://i.pinimg.com/1200x/2b/29/1d/2b291d6701a3f3fcf91fc96e41d9a20d.jpg');
            }
            .container-box { padding: 20px; }
            h1 { font-size: 1.5rem; }
            label { font-size: 0.9rem; }
            .result { font-size: 0.8rem; }
        }

        .pb-result-pass { color: green; font-weight: bold; opacity: 0; transition: opacity 0.8s ease-in; }
        .pb-result-fail { color: red; font-weight: bold; opacity: 0; transition: opacity 0.8s ease-in; }
        .fade-in { opacity: 1 !important; }

        .tab-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
            margin-top: 10px;
        }
        .tab-buttons .btn-custom {
            min-width: 150px;
            padding: 10px 20px;
        }

        /* Ajuste especial para celular */
        @media (max-width: 576px) {

            .tab-buttons {
                flex-direction: column;     /* Ficam um embaixo do outro */
                gap: 10px;                  /* Espa√ßo entre eles */
                width: 100%;
            }

            .tab-buttons .btn-custom {
                width: 100%;                /* Cada bot√£o ocupa toda a largura */
                min-width: unset;
            }

            .container-box {
                max-width: 100% !important; /* Garante ajuste perfeito no mobile */
                padding: 20px;
            }
        }
        
    </style>
</head>

<body>

    <!-- CONTAINER PRINCIPAL -->
    <div class="container-box">

        <!-- BOT√ïES DE ABA -->
        <div class="tab-buttons">
            <button class="btn btn-custom" onclick="mostrarACG()">ACG / ACEE</button>
            <button class="btn btn-custom" onclick="mostrarPB()">PB I ‚Ä¢ II ‚Ä¢ III</button>
            <button class="btn btn-custom" onclick="mostrarPB4()">PB IV</button>
        </div>

        <h1>Calculadora da Barbie üíï</h1>

        <!-- ABA ACG -->
        <div id="aba-acg">
            <!-- Bot√£o de ajuda -->
                <button type="button" class="btn btn-custom w-100 mb-3" 
                    data-bs-toggle="modal" data-bs-target="#modalAjuda">
                    Ajuda üí°
                </button>

                <!-- Modal -->
                <div class="modal fade" id="modalAjuda" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Como funciona a calculadora?</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>

                            <div class="modal-body">

                                <h6>Calculadora ACG</h6>
                                <p>
                                    Insira a categoria da atividade realizada (ensino, pesquisa, extens√£o ou cultural) 
                                    e a carga hor√°ria correspondente.  
                                    Lembre que certificados usados nas ACEEs n√£o podem ser usados na Extens√£o.
                                </p>

                                <p>Documento oficial das ACGs:</p>
                                <a href="https://cursos.unipampa.edu.br/cursos/medicina/files/2024/08/comissao-interna-de-avaliacao-de-acgs-curso-de-medicina-r7-docx--02-07.pdf">
                                    Acessar Documento
                                </a>

                                <h6 class="mt-3">Calculadora ACEE</h6>
                                <p>
                                    Informe as horas de OACEE e Atividades de Extens√£o.  
                                    O programa ir√° verificar se voc√™ atingiu o m√≠nimo exigido.
                                </p>

                                <p><strong>Dica:</strong> participa√ß√£o como ouvinte conta APENAS META da carga hor√°ria.</p>
                            </div>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-custom" data-bs-dismiss="modal">
                                    Entendi!
                                </button>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- FORM ACG -->
                <form id="acg-form">
                    <h4>Calculadora ACG</h4>

                    <label for="categoria">Categoria</label>
                    <select id="categoria" class="form-select mb-3">
                        <option value="ensino">Ensino</option>
                        <option value="pesquisa">Pesquisa</option>
                        <option value="extensao">Extens√£o</option>
                        <option value="cultural">Cultural</option>
                    </select>

                    <label for="carga">Carga Hor√°ria</label>
                    <input type="number" id="carga" min="1" class="form-control mb-3">

                    <button type="button" class="btn btn-custom w-100" onclick="adicionarAtividade()">
                        Adicionar Atividade
                    </button>

                    <div class="mt-3">
                        <button class="btn btn-danger btn-inline" type="button" onclick="limparACG()">Limpar Tudo</button>
                        <button class="btn btn-danger btn-inline" type="button" onclick="limparUltimaAtividade()">Limpar √öltima</button>
                    </div>
                </form>

                <div id="resultado" class="result mt-3">
                    Nenhuma atividade adicionada ainda üíî
                </div>

                <!-- FORM ACEE -->
                <form id="acee-form" class="mt-4">
                    <h4>Calculadora ACEE</h4>

                    <label for="oacee">Horas OACEE</label>
                    <input type="number" id="oacee" min="0" class="form-control mb-3" value="0">

                    <label for="unipampa">Horas Atividades de Extens√£o</label>
                    <input type="number" id="unipampa" min="0" class="form-control mb-3" value="0">

                    <button type="button" class="btn btn-custom w-100" onclick="calcularACEE()">
                        Calcular ACEE
                    </button>

                    <div class="mt-3">
                        <button class="btn btn-danger btn-inline" type="button" onclick="limparACEE()">Limpar Tudo</button>
                        <button class="btn btn-danger btn-inline" type="button" onclick="limparUltimaACEE()">Limpar √öltima</button>
                    </div>
                </form>

                <div id="resultado-acee" class="result mt-3">
                    Nenhuma hora de ACEE adicionada ainda üíî
                </div>

            </div> <!-- FIM ACG -->
        <!-- ABA PROCESSOS BIOL√ìGICOS I, II, III -->
        <div id="aba-pb" style="display:none;">

            <h1>Processos Biol√≥gicos üíó</h1>
            <h4>PB I ‚Ä¢ PB II ‚Ä¢ PB III</h4>

            <label for="cog1">Cognitiva I</label>
            <input type="number" id="cog1" class="form-control mb-2" min="0" max="10" value="0">

            <label for="cog2">Cognitiva II</label>
            <input type="number" id="cog2" class="form-control mb-2" min="0" max="10" value="0">

            <label for="anat1">Anatomia I</label>
            <input type="number" id="anat1" class="form-control mb-2" min="0" max="10" value="0">

            <label for="anat2">Anatomia II</label>
            <input type="number" id="anat2" class="form-control mb-2" min="0" max="10" value="0">

            <label for="ibc">IBC</label>
            <input type="number" id="ibc" class="form-control mb-2" min="0" max="10" value="0">

            <label for="histo1">Histo I</label>
            <input type="number" id="histo1" class="form-control mb-2" min="0" max="10" value="0">

            <label for="histo2">Histo II</label>
            <input type="number" id="histo2" class="form-control mb-2" min="0" max="10" value="0">

            <label for="formativa">Formativa</label>
            <input type="number" id="formativa" class="form-control mb-3" min="0" max="10" value="0">

            <button type="button" class="btn btn-custom w-100" onclick="calcularPB()">
                Calcular Nota
            </button>

            <div id="resultado-pb" class="result mt-3">
                Nenhuma nota inserida ainda üíî
            </div>

        </div> <!-- FIM ABA PB -->
        <!-- CONTAINER PB IV -->
        <div class="container-box" id="pb4-container" style="display:none;">

            <h1>Processos Biol√≥gicos IV üíó</h1>

            <label for="cog1_4">Cognitiva I</label>
            <input type="number" id="cog1_4" class="form-control mb-2" min="0" max="10" value="0">

            <label for="cog2_4">Cognitiva II</label>
            <input type="number" id="cog2_4" class="form-control mb-2" min="0" max="10" value="0">

            <label for="formativa_4">Formativa</label>
            <input type="number" id="formativa_4" class="form-control mb-2" min="0" max="10" value="0">

            <label for="micro1_4">Microbiologia I</label>
            <input type="number" id="micro1_4" class="form-control mb-2" min="0" max="10" value="0">

            <label for="micro2_4">Microbiologia II</label>
            <input type="number" id="micro2_4" class="form-control mb-2" min="0" max="10" value="0">

            <label for="pato_4">Patologia</label>
            <input type="number" id="pato_4" class="form-control mb-3" min="0" max="10" value="0">

            <button type="button" class="btn btn-custom w-100" onclick="calcularPB4()">Calcular Nota</button>

            <div id="resultado-pb4" class="result mt-3">
                Nenhuma nota inserida ainda üíî
            </div>

        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <script>

            /* ------------------------------------
               LOCAL STORAGE E INICIALIZA√á√ÉO
            --------------------------------------*/
            let atividades = JSON.parse(localStorage.getItem('atividades')) || [];
            let aceeData = JSON.parse(localStorage.getItem('aceeData')) || { oacee: 0, unipampa: 0 };
            let aceeHistorico = [];

            document.addEventListener('DOMContentLoaded', () => {
                atualizarResumo();
                atualizarResumoACEE();
            });

            /* ------------------------------------
               ACG ‚Äî ADICIONAR ATIVIDADES
            --------------------------------------*/
            function adicionarAtividade() {
                const categoria = document.getElementById('categoria').value;
                const carga = parseInt(document.getElementById('carga').value);

                if (!carga || carga <= 0) {
                    alert("Insira uma carga hor√°ria v√°lida.");
                    return;
                }

                const totalAtual = atividades
                    .filter(a => a.categoria === categoria)
                    .reduce((acc, a) => acc + a.carga, 0);

                const cargaFinal = Math.min(95, totalAtual + carga);

                if (cargaFinal > totalAtual) {
                    atividades.push({ categoria, carga: cargaFinal - totalAtual });
                    localStorage.setItem("atividades", JSON.stringify(atividades));
                } else {
                    alert(`Limite de 95h atingido para ${categoria}.`);
                }

                atualizarResumo();
            }

            /* ------------------------------------
               ACG ‚Äî RESUMO
            --------------------------------------*/
            function atualizarResumo() {
                const totalPorCategoria = { ensino: 0, pesquisa: 0, extensao: 0, cultural: 0 };
                let totalGeral = 0;

                atividades.forEach(a => {
                    totalPorCategoria[a.categoria] += a.carga;
                    totalGeral += a.carga;
                });

                let resumo = `<p>Total Geral: <strong>${totalGeral}</strong> horas</p><ul>`;

                for (let cat in totalPorCategoria) {
                    const nome = cat.charAt(0).toUpperCase() + cat.slice(1);
                    const total = totalPorCategoria[cat];

                    resumo += `<li>${nome}: ${total} horas`;

                    if (cat !== "extensao" && total < 20) {
                        resumo += ` <span class="text-danger">(Faltam ${20 - total}h)</span>`;
                    }

                    resumo += `</li>`;
                }

                resumo += `</ul>`;

                const faltaGeral = Math.max(
                    135 - totalGeral,
                    ...Object.values(totalPorCategoria).map(v => v < 20 ? 20 - v : 0)
                );

                if (
                    totalGeral >= 135 &&
                    totalPorCategoria.ensino >= 20 &&
                    totalPorCategoria.pesquisa >= 20 &&
                    totalPorCategoria.cultural >= 20
                ) {
                    resumo += `<p class="text-success">üéâ Parab√©ns! Voc√™ concluiu as ACGs.</p>`;
                } else {
                    resumo += `<p class="text-danger">üíî Voc√™ ainda precisa de ${faltaGeral}h no total ou em categorias espec√≠ficas.</p>`;
                }

                document.getElementById("resultado").innerHTML = resumo;
            }

            /* ------------------------------------
               ACEE ‚Äî C√ÅLCULO
            --------------------------------------*/
            function calcularACEE() {
                aceeHistorico.push({ ...aceeData });

                const oacee = parseInt(document.getElementById("oacee").value) || 0;
                const unipampa = parseInt(document.getElementById("unipampa").value) || 0;

                aceeData.oacee += oacee;
                aceeData.unipampa += unipampa;

                localStorage.setItem("aceeData", JSON.stringify(aceeData));

                document.getElementById("oacee").value = "";
                document.getElementById("unipampa").value = "";

                atualizarResumoACEE();
            }

            function atualizarResumoACEE() {
                const { oacee, unipampa } = aceeData;

                const MIN_OACEE = 60;
                const MIN_EXT = 65;

                let html = `
                    <p>Total OACEE: ${oacee}h</p>
                    <p>Total Atividades de Extens√£o: ${unipampa}h</p>
                `;

                if (oacee >= MIN_OACEE && unipampa >= MIN_EXT) {
                    html += `<p class="text-success">üéâ Parab√©ns! Requisitos de ACEE conclu√≠dos!</p>`;
                } else {
                    if (oacee < MIN_OACEE)
                        html += `<p class="text-danger">Faltam ${MIN_OACEE - oacee}h para OACEE.</p>`;
                    if (unipampa < MIN_EXT)
                        html += `<p class="text-danger">Faltam ${MIN_EXT - unipampa}h para Atividades de Extens√£o.</p>`;
                }

                document.getElementById("resultado-acee").innerHTML = html;
            }

            /* ------------------------------------
               ACEE LIMPAR
            --------------------------------------*/
            function limparACEE() {
                if (confirm("Deseja realmente apagar todos os dados de ACEE?")) {
                    aceeData = { oacee: 0, unipampa: 0 };
                    aceeHistorico = [];
                    localStorage.removeItem("aceeData");
                    atualizarResumoACEE();
                }
            }

            function limparUltimaACEE() {
                if (aceeHistorico.length > 0) {
                    aceeData = aceeHistorico.pop();
                    localStorage.setItem("aceeData", JSON.stringify(aceeData));
                    atualizarResumoACEE();
                } else {
                    alert("Nenhum passo anterior dispon√≠vel.");
                }
            }

            /* ------------------------------------
               TROCA ENTRE ABAS
            --------------------------------------*/
            function mostrarACG() {
                document.getElementById("aba-acg").style.display = "block";
                document.getElementById("aba-pb").style.display = "none";
                document.getElementById("pb4-container").style.display = "none";
            }

            function mostrarPB() {
                document.getElementById("aba-acg").style.display = "none";
                document.getElementById("aba-pb").style.display = "block";
                document.getElementById("pb4-container").style.display = "none";
            }

            function mostrarPB4() {
                document.getElementById("aba-acg").style.display = "none";
                document.getElementById("aba-pb").style.display = "none";
                document.getElementById("pb4-container").style.display = "block";
            }

            /* ------------------------------------
               C√ÅLCULO PB I - II - III
            --------------------------------------*/
            function calcularPB() {
                const n1 = parseFloat(document.getElementById("cog1").value) || 0;
                const n2 = parseFloat(document.getElementById("cog2").value) || 0;
                const a1 = parseFloat(document.getElementById("anat1").value) || 0;
                const a2 = parseFloat(document.getElementById("anat2").value) || 0;
                const ibc = parseFloat(document.getElementById("ibc").value) || 0;
                const h1 = parseFloat(document.getElementById("histo1").value) || 0;
                const h2 = parseFloat(document.getElementById("histo2").value) || 0;
                const form = parseFloat(document.getElementById("formativa").value) || 0;

                const somaPonderada =
                    n1 * 2.4 +
                    n2 * 2.4 +
                    a1 * 1.0 +
                    a2 * 1.0 +
                    ibc * 1.5 +
                    h1 * 0.25 +
                    h2 * 0.25 +
                    form * 1.2;

                const notaFinal = somaPonderada / 10;

                const div = document.getElementById("resultado-pb");
                let mensagem = "";
                let classe = "";

                if (notaFinal >= 6) {
                    mensagem = `üéâ Parab√©ns! Voc√™ passou! Nota final: <strong>${notaFinal.toFixed(2)}</strong>`;
                    classe = "pb-result-pass";
                } else {
                    const falta = (6 - notaFinal).toFixed(2);
                    mensagem = `üíî Voc√™ n√£o atingiu a m√©dia. Faltam <strong>${falta}</strong> pontos.`;
                    classe = "pb-result-fail";
                }

                div.className = `result mt-3 ${classe}`;
                div.innerHTML = mensagem;

                setTimeout(() => div.classList.add("fade-in"), 50);
            }

            /* ------------------------------------
               C√ÅLCULO PB IV
            --------------------------------------*/
            function calcularPB4() {
                const n1 = parseFloat(document.getElementById('cog1_4').value) || 0;
                const n2 = parseFloat(document.getElementById('cog2_4').value) || 0;
                const form = parseFloat(document.getElementById('formativa_4').value) || 0;
                const m1 = parseFloat(document.getElementById('micro1_4').value) || 0;
                const m2 = parseFloat(document.getElementById('micro2_4').value) || 0;
                const pat = parseFloat(document.getElementById('pato_4').value) || 0;

                const somaPonderada =
                    n1 * 2.8 +
                    n2 * 2.8 +
                    form * 1.4 +
                    m1 * 0.75 +
                    m2 * 0.75 +
                    pat * 1.5;

                const notaFinal = somaPonderada / 10;

                const div = document.getElementById('resultado-pb4');

                if (notaFinal >= 6) {
                    div.className = "pb-result-pass fade-in";
                    div.innerHTML = `üéâ Parab√©ns! Voc√™ passou! Nota final: ${notaFinal.toFixed(2)}`;
                } else {
                    const falta = (6 - notaFinal).toFixed(2);
                    div.className = "pb-result-fail fade-in";
                    div.innerHTML = `üíî Voc√™ n√£o atingiu a m√©dia. Faltam ${falta} pontos.`;
                }
            }

        </script>
